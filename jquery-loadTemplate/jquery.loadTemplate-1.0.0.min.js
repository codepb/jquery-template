(function (e) { "use strict"; function i(n, r, i) { var s = this, h, p, d; r = r || {}; p = e.extend({ overwriteCache: false, complete: null, success: null, error: function () { e(this).each(function () { e(this).html(p.errorMessage) }) }, errorMessage: "There was an error loading the template.", paged: false, pageNo: 1, elemPerPage: 10, append: false }, i); if (e.type(r) === "array") { return u.call(this, n, r, p) } if (!o(n)) { h = e(n) } d = p.isFile || typeof p.isFile === "undefined" && (typeof h === "undefined" || h.length === 0); if (d && !p.overwriteCache && t[n]) { f(n, s, r, p) } else if (d && !p.overwriteCache && t.hasOwnProperty(n)) { a(n, s, r, p) } else if (d) { l(n, s, r, p) } else { c(h, s, r, p) } return this } function s(t, n) { if (n) { r[t] = n } else { r = e.extend(r, t) } } function o(e) { return typeof e === "string" && e.indexOf("/") > -1 } function u(t, n, r) { var s = this, o = n.length, u = 0, a; r = r || {}; if (r.paged) { var f = (r.pageNo - 1) * r.elemPerPage; n = n.slice(f, f + r.elemPerPage) } a = e.extend({}, r, { complete: function () { s.append(this.html()); u++; if (u === o) { if (r && typeof r.complete === "function") { r.complete() } } } }); if (!r.append) { s.html("") } e(n).each(function () { var n = e("<div/>"); i.call(n, t, this, a) }); return this } function a(e, t, r, i) { if (n[e]) { n[e].push({ data: r, selection: t, settings: i }) } else { n[e] = [{ data: r, selection: t, settings: i }] } } function f(e, n, r, i) { var s = t[e].clone(); h.call(n, s, r, i); if (typeof i.success === "function") { i.success() } } function l(n, r, i, s) { var o = e("<div/>"); t[n] = null; o.load(n, function (e, t) { if (t === "error") { p(n, r, i, s) } else { d(o, n, r, i, s) } }) } function c(t, n, r, i) { var s = e("<div/>"); if (t.is("script")) { t = e.parseHTML(e.trim(t.html())) } s.html(t); h.call(n, s, r, i); if (typeof i.success === "function") { i.success() } } function h(t, n, r) { v(t, n); e(this).each(function () { if (r.append) { e(this).append(t.html()) } else { e(this).html(t.html()) } }); if (typeof r.complete === "function") { r.complete.call(e(this)) } } function p(t, r, i, s) { var o; if (typeof s.error === "function") { s.error.call(r) } e(n[t]).each(function (e, t) { if (typeof t.settings.error === "function") { t.settings.error.call(t.selection) } }); if (typeof s.complete === "function") { s.complete.call(r) } while (n[t] && (o = n[t].shift())) { if (typeof o.settings.complete === "function") { o.settings.complete.call(o.selection) } } if (typeof n[t] !== "undefined" && n[t].length > 0) { n[t] = [] } } function d(e, r, i, s, o) { var u; t[r] = e.clone(); h.call(i, e, s, o); if (typeof o.success === "function") { o.success.call(i) } while (n[r] && (u = n[r].shift())) { h.call(u.selection, t[r].clone(), u.data, u.settings); if (typeof u.settings.success === "function") { u.settings.success.call(u.selection) } } } function v(t, n) { n = n || {}; m("data-content", t, n, function (e, t) { e.html(w(e, t, "content")) }); m("data-content-append", t, n, function (e, t) { e.append(w(e, t, "content")) }); m("data-content-prepend", t, n, function (e, t) { e.prepend(w(e, t, "content")) }); m("data-src", t, n, function (e, t) { e.attr("src", w(e, t, "src")) }, function (e) { e.remove() }); m("data-alt", t, n, function (e, t) { e.attr("alt", w(e, t, "alt")) }); m("data-value", t, n, function (e, t) { e.val(w(e, t, "value")) }); m("data-link", t, n, function (t, n) { var r = e("<a/>"); r.attr("href", w(t, n, "link")); r.html(t.html()); t.html(r) }); m("data-link-wrap", t, n, function (t, n) { var r = e("<a/>"); r.attr("href", w(t, n, "link-wrap")); t.wrap(r) }); m("data-options", t, n, function (t, n) { e(n).each(function () { var n = e("<option/>"); n.attr("value", this).text(this).appendTo(t) }) }); g(t, n) } function m(t, n, r, i, s) { e("[" + t + "]", n).each(function () { var n = e(this), o = n.attr(t), u = b(r, o); n.removeAttr(t); if (u && i) { i(n, u) } else if (s) { s(n) } }); return } function g(t, n) { e("[data-template-bind]", t).each(function () { var t = e(this), r = e.parseJSON(t.attr("data-template-bind")); t.removeAttr("data-template-bind"); e(r).each(function () { var r; if (typeof this.value === "object") { r = b(n, this.value.data) } else { r = b(n, this.value) } if (typeof r !== "undefined" && this.attribute) { switch (this.attribute) { case "content": t.html(y(r, this)); break; case "contentAppend": t.append(y(r, this)); break; case "contentPrepend": t.prepend(y(r, this)); break; case "options": var i = this; e(r).each(function () { var n = e("<option/>"); n.attr("value", this[i.value.value]).text(y(this[i.value.content], i)).appendTo(t) }); break; default: t.attr(this.attribute, y(r, this)) } } }) }) } function y(e, t) { if (t.formatter && r[t.formatter]) { return r[t.formatter](e, t.formatOptions) } return e } function b(e, t) { var n = t.split("."), r, i = e; while ((r = n.shift()) && typeof i !== "undefined") { i = i[r] } return i } function w(e, t, n) { var i = e.attr("data-format-target"), s; if (i === n || !i && n === "content") { s = e.attr("data-format"); if (s && typeof r[s] === "function") { var o = e.attr("data-format-options"); return r[s](t, o) } } return t } var t = {}, n = {}, r = {}; e.fn.loadTemplate = i; e.addTemplateFormatter = s })(jQuery)